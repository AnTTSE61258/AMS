@using Microsoft.AspNet.Identity
@{
    ViewBag.Title = "ReceiptView";
    Layout = "~/Views/Management/__ManagementLayout.cshtml";
}

<div class="col-md-12" @*style="-webkit-transition: all 0.3s;-moz-transition: all 0.3s;transition: all 0.3s;"*@>
    <div class="panel panel-default">
        
        <div class="heading-tab">
            <i class="fa fa-list"> Danh sách hóa đơn</i>
            <ul class="nav nav-tabs pull-right" role="tablist">
                <li class="active">
                    <a href="/Management/ManageReceipt/View/@User.Identity.GetUserId()"><i class="fa fa-file-text-o"></i> Quản lý hóa đơn</a>
                </li>
                <li>
                    <a href="/Management/ManageReceipt/@User.Identity.GetUserId()"><i class="fa fa fa-plus"></i> Tạo hóa đơn thủ công</a>
                </li>
            </ul>
        </div>

        <div class="panel-body">

            <div class="tab-content">
                <div class="tab-pane fade active in" id="">

                    <div class="form-horizontal" role="form">
                        <table id="managerOrderTbl" data-userid="@User.Identity.GetUserId()" class="table table-hover table-bordered">
                            <thead>
                            <tr>
                                <th></th>
                                <th>Tiêu đề</th>
                                <th>Căn hộ</th>
                                <th>Tổng</th>
                                <th>Trạng thái</th>
                                <th>Ngày tạo</th>
                                <th></th>
                            </tr>
                            </thead>
                            <tfoot>
                            <tr>
                                <th></th>
                                <th>Tiêu đề</th>
                                <th>Căn hộ</th>
                                <th>Tổng</th>
                                <th>Trạng thái</th>
                                <th>Ngày tạo</th>
                                <th></th>
                            </tr>
                            </tfoot>
                            <tbody></tbody>
                        </table>

                    </div>

                </div>
            </div>

        </div>
    </div>
</div>


<script>
    $(document).ready(function () {
        var fromUserId = document.getElementById("managerOrderTbl").dataset.userid;
        var dataTable5 = $("#managerOrderTbl").DataTable({
            "ajax": {
                url: "/Management/ManageReceipt/Admin/GetManagerOrderList?userId=" + fromUserId,
                dataSrc: ""
            },
            "bLengthChange": false,
            "bInfo": false,
            "columns": [
                { data: "ReceiptTitle" },
                { data: "ReceiptTitle" },
                { data: "HouseName" },
                { data: "TotalOrder" },
                { data: "Status" },
                { data: "CreateDate" },
                { data: "ReceiptId" }
            ],
            "columnDefs": [
            {
                "searchable": false,
                "orderable": false,
                "targets": 0
            },
            {
                "targets": 2,
                "data": "HouseName",
                "render": function (data, type, full, meta) {
                    if (type === "display" || type === "filter") {
                        return "<span class='label house-color label-warning'>" + data + "</span>";
                    }
                    return data;
                }
            },
            {
                "targets": 4,
                "data": "Status",
                "render": function (data, type, full) {
                    if (type === "display" || type === "filter") {
                        if (data === window.StatusUnpaid) {
                            return "<span class='label label-danger'> Chưa thanh toán</div>";
                        } else if (data === window.StatusPaid) {
                            return "<span class='label label-info'>" + "Đã thanh toán" + "</div>";
                        } else if (data === window.StatusUnpublished) {
                            return "<span class='label label-default'>" + "Chưa công bố" + "</div>";
                        }
                    }
                    return data;
                }
            },
            {
                "targets": 5,
                "data": "CreateDate",
                "render": function (data, type, full) {
                    if (type === "display" || type === "filter") {
                        if (data !== null && data !== undefined) {
                            var dateTime = data.split(" ");
                            return "<span class='label date-color label-warning'>" + dateTime[0] +
                                "</span>  <span class='label time-color label-gray'>" + dateTime[1] + "</span>";
                        }
                    }
                    return data;
                }
            }, {
                "targets": 6,
                "data": "ReceiptId",
                "render": function (data, type, full) {
                    if (type === "display" || type === "filter") {
                        if (data !== null && data !== undefined) {
                            return "<span onclick='editOrderDetail(" + data + "," + fromUserId + ")' class='btn btn-default btn-xs lbl-margin-right'>" +
                                "<i class='fa fa-pencil'></i>" +
                                "</span> ";
                        }
                    }
                    return data;
                }
            }
            ]
        });
        generateTableIndex(dataTable5);
    });

</script>
